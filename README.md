# ComfyUI-QHNodes

为 ComfyUI 开发的自定义节点集合，提供预设尺寸预设Latent、从文件夹加载LoRA。

## 安装方法

1. 将此仓库克隆到你的 `ComfyUI/custom_nodes/` 目录下：
```bash
cd ComfyUI/custom_nodes/
git clone https://github.com/liuqianhonga/ComfyUI-QHNodes.git
```

2. 重启 ComfyUI

## 可用节点

### 预设尺寸 (Preset Size Latent)
为社交媒体和相机生成预设尺寸的 latent。

#### 功能特点：
- 支持中国和国际主流社交媒体平台的预设尺寸
- 支持常用相机和手机拍摄尺寸（16:9、4:3、3:2等）
- 支持自定义分辨率（64×64 到 8192×8192）
- 支持宽高切换
- 支持尺寸缩放（0.1 到 10.0）
- 支持批量生成（1-64）
- 可通过 JSON 文件自定义预设

#### 参数说明：
- **预设类型 (Preset Type)**: 选择预设类型（社交媒体/相机尺寸/自定义）
- **社交媒体预设 (Social Preset)**: 选择预设的社交媒体平台尺寸
- **相机预设 (Camera Preset)**: 选择预设的相机尺寸和比例
- **宽度 (Width)**: 自定义输出宽度，范围 64-8192
- **高度 (Height)**: 自定义输出高度，范围 64-8192
- **交换宽高 (Swap Width/Height)**: 交换宽度和高度
- **缩放比例 (Scale Factor)**: 对尺寸进行整体缩放，范围 0.1-10.0
- **批次大小 (Batch Size)**: 一次生成的数量，范围 1-64

#### 支持的预设尺寸：

##### 手机拍摄预设
- **竖屏人像**
  - 16:9 (1080×1920) - 适合人像/全身照
  - 4:3 (1440×1920) - 适合证件照/半身像
  - 3:2 (1280×1920) - 适合风景/建筑
- **方形格式**
  - 通用方形 (1024×1024) - 适合头像/产品图
  - 高清方形 (1920×1920) - 适合精致产品/艺术作品

##### 视频尺寸
- 4K (3840×2160)
- 2K (2048×1152)
- 1080p (1920×1080)
- 电影比例 (2048×870)

##### 相片尺寸
- 4×6英寸 (1200×1800) - 适合冲印照片
- 5×7英寸 (1500×2100) - 适合相框装饰

##### 社交媒体平台

###### 国内平台
- **抖音/快手**
  - 竖屏 (1080×1920) - 适合短视频封面
- **朋友圈**
  - 标准尺寸 (1080×1920) - 适合生活分享
- **小红书**
  - 标准尺寸 (1080×1350) - 适合美食/穿搭
- **微博**
  - 标准尺寸 (1200×900) - 适合图文/新闻
- **B站**
  - 封面 (1146×717) - 适合视频封面

###### 国际平台
- **Instagram**
  - Story (1080×1920) - 适合故事/Vlog
- **TikTok**
  - Video (1080×1920) - 适合短视频/舞蹈
- **Facebook**
  - Post (1200×630) - 适合社交分享
- **Twitter**
  - Post (1200×675) - 适合资讯/新闻
- **Youtube**
  - Cover (2560×1440) - 适合视频封面

#### 自定义预设

你可以通过编辑以下文件来添加自己的预设尺寸：
- `nodes/preset_sizes.json`: 社交媒体预设
- `nodes/camera_sizes.json`: 相机尺寸预设

格式如下：
```json
{
    "预设名称 (宽×高)": [宽度, 高度]
}
```

### 🐟 Load LoRA (Folder)

从指定文件夹加载 LoRA 模型。支持以下功能：

- **文件夹路径**：支持多个文件夹路径，使用英文逗号分隔
  - 示例：`myLoras, character/style1`
  - 相对路径基于 ComfyUI 的 `models/loras` 目录
  - 如果路径不存在会在控制台输出提示信息
- **文件过滤**：支持文件名过滤，使用英文逗号分隔多个关键词
  - 示例：`anime, style` 将只加载文件名包含 anime 或 style 的 LoRA
  - 过滤词不区分大小写
  - 留空则加载目录下所有 .safetensors 文件
- **模型强度**：调整 LoRA 模型对生成结果的影响程度
  - 范围：-100.0 到 100.0
  - 默认值：1.0
  - 负值会产生相反的效果
- **实时预览**：执行后会显示找到的 LoRA 文件列表，方便确认是否正确加载

#### 使用示例

1. 加载单个文件夹：
   ```
   lora_folders: myLoras
   filter_text: (留空)
   strength_model: 1.0
   ```

2. 加载多个文件夹并过滤：
   ```
   lora_folders: portraits, anime/style
   filter_text: v1, quality
   strength_model: 0.8
   ```

#### 注意事项

- 文件夹路径使用正斜杠 `/` 分隔
- 目前仅支持 .safetensors 格式的 LoRA 文件
- 如果找不到任何符合条件的文件，节点会显示"No LoRA files found"
